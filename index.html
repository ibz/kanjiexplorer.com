---
layout: null
---

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<title>Kanji Explorer</title>
<script src="{{ site.baseurl }}/utils.js" type="text/javascript"></script>
<script src="{{ site.baseurl }}/elements.json" type="text/javascript"></script>
<link rel="stylesheet" href="{{ site.baseurl }}/style.css">

<script type="text/javascript">//<![CDATA[

var curr;
var hovered;

var KANJI_WIDTH = 100;
var KANJI_HEIGHT = 100;

function get_svg(v, link) {
    if (link) {
        return '<a class="kanji" href="javascript:update(' + v + ', true)" id="' + v + '"><object data="{{ site.baseurl }}/svg/' + v + '.svg" width="' + KANJI_WIDTH + '" height="' + KANJI_HEIGHT + '" type="image/svg+xml" /></a> ';
    } else {
        return '<object data="{{ site.baseurl }}/svg/' + v + '.svg" width="' + KANJI_WIDTH + '" height="' + KANJI_HEIGHT + '" type="image/svg+xml" />';
    }
}

function update_dict(v) {
    doGet("{{ site.baseurl }}/dict/" + v + ".json",
        function(data) {
            var text = "";
            if (data['character']) {
                text += "unicode: " + data['character'] + "<br />";
            }
            if (data['meanings']) {
                text += "meaning: " + data['meanings'].toLowerCase() + "<br />";
            }
            if (data['readings'] && (data['readings']['on'] || data['readings']['kun'])) {
                text += "reading: ";
                if (data['readings']['on']) {
                    text += data['readings']['on'] + " (on) "
                }
                if (data['readings']['kun']) {
                    text += data['readings']['kun'] + " (kun) ";
                }
            }
            if (v == hovered) {
                document.getElementById('dict').innerHTML = text;
            }
        },
        function() {
            if (v == hovered) {
                document.getElementById('dict').text = "";
            }
        });
}

function update_curr(v) {
    document.getElementById("curr").innerHTML = get_svg(v, false);
}

function update(next, clear_help) {
    curr = next;

    update_curr(curr);
    update_dict(curr);

    var next_refs = elements[next.toString()];
    var refs_0_el = document.getElementById("refs_0");
    refs_0_el.innerHTML = "";
    for (var i = 0; i < next_refs[0].length; i++) {
        refs_0_el.innerHTML += get_svg(next_refs[0][i], true);
    }
    var refs_1_el = document.getElementById("refs_1");
    refs_1_el.innerHTML = "";
    for (var i = 0; i < next_refs[1].length; i++) {
        refs_1_el.innerHTML += get_svg(next_refs[1][i], true);
    }

    if (clear_help) {
        document.getElementById("help").text = "";
    }

    window.location.hash = "#" + curr;

    for (const a of document.querySelectorAll("a.kanji")) {
        a.addEventListener('mouseover', function() { hovered = this.id; update_curr(hovered); update_dict(hovered); });
        a.addEventListener('mouseout', function() { hovered = curr; update_curr(hovered); update_dict(hovered); });
    }
}

function get_random_element() {
    var max = 0;
    for (k in elements) {
        if (parseInt(k) > max) {
            max = k;
        }
    }

    var r;
    do {
         r = (Math.floor(Math.random() * max) + 1).toString();
    } while (!elements.hasOwnProperty(r));

    return r;
}

function update_from_hash() {
    if (window.location.hash == "") {
        update(get_random_element(), false);
    } else {
        update(window.location.hash.substring(1), false);
    }
}

window.addEventListener('load', function () {
    update_from_hash();

    window.addEventListener('hashchange', update_from_hash);
}, false);

//]]></script>
</head>
<body>
  <table width="100%" height="100%">
  <tr><td valign="center">
  <p align="center" id="help">How it works: you start with a random kanji. You can see its components (above) and its derivatives (below).<br />Hover any of those to see its definition, click to navigate.</p>
  <table width="100%" style="vertical-align: center">
    <tr><td id="refs_0" align="center" style="background: #cccccc" height="100px" colspan="2"></td></tr>
    <tr><td id="curr" align="right" style="background: #eeeeee; padding-right: 20px;" height="120px" width="50%"></td><td id="dict" align="left" style="padding-left: 20px;" height="120px" width="50%"></td></tr>
    <tr><td id="refs_1" align="center" style="background: #cccccc" height="100px" colspan="2"></td></tr>
  </table>
  <p align="center"><a href="{{ site.url }}{{ site.baseurl }}/about.html">(about)</a></p>
  </td></tr>
  </table>
</body>
</html>